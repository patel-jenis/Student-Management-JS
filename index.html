<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Remix Icon -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" rel="stylesheet" />
    <!-- Bootsrap CSS -->
    <link rel="stylesheet" href="./assets/css/bootstrap.css">
    <!-- Style CSS -->
    <link rel="stylesheet" href="./assets/css/style.css">
    <!-- Media CSS -->
    <link rel="stylesheet" href="./assets/css/media.css">
</head>

<body>

    <h1>Student Management System</h1>

    <section class="mt-5 mb-4 px-sm-3 px-0">
        <div class="container-fluid">
            <div class="row g-5">
                <div class="col-xl-4 col-12">
                    <div class="outer-box">
                        <h3 class="text-center fw-semibold mt-3 mb-2">Manage Students</h3>
                        <div class="mt-5 form-details">
                            <form action="">
                                <div class="mb-4">
                                    <label for="grId" class="form-label">GR ID : </label>
                                    <input type="number" class="form-control" id="grId">
                                </div>
                                <div class="mb-4">
                                    <label for="name" class="form-label">Name :</label>
                                    <input type="text" class="form-control" id="name">
                                </div>
                                <div class="mb-4">
                                    <label for="age" class="form-label">Age : </label>
                                    <input type="number" class="form-control" id="age">
                                </div>
                                <div class="mb-4 d-flex align-items-center gap-3">
                                    <label for="course" class="form-label m-0">Course : </label>
                                    <select class="form-select" id="course">
                                        <option value="">Select Course</option>
                                        <option value="1">Full Stack Developement</option>
                                        <option value="2">UI / UX DESIGN</option>
                                        <option value="3">AI / ML </option>
                                    </select>
                                </div>
                                <div class="mb-5">
                                    <label for="gender" class="form-label">Gender : </label>
                                    <label for="male">
                                        <input type="radio" name="gender" id="male" class="mx-2 form-check-input"
                                            value="Male" checked>Male
                                    </label>
                                    <label for="female">
                                        <input type="radio" name="gender" id="female" class="mx-2 form-check-input"
                                            value="Female">Female
                                    </label>
                                </div>
                                <div class="d-flex gap-3 justify-content-center btn-box">
                                    <button class="op-btn" id="submit-btn">Insert</button>
                                    <button class="op-btn" id="clr">Clear</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col-xl-8 col-12">
                    <div class="container-main">
                        <div class="inner-box">
                            <table class="table text-center table-striped">
                                <thead>
                                    <tr>
                                        <th scope="col">Sr_No</th>
                                        <th scope="col">GR_ID</th>
                                        <th scope="col">Name</th>
                                        <th scope="col">Course</th>
                                        <th scope="col">Age</th>
                                        <th scope="col">Gender</th>
                                        <th scope="col">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="result">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- <script src="./assets/js/jquery.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>

        let input1 = document.getElementById("grId");
        let input2 = document.getElementById("name");
        let input3 = document.getElementById("course");
        let input4 = document.getElementById("age");
        let submitBtn = document.getElementById("submit-btn");

        function clearData() {
            input1.value = "";
            input2.value = "";
            input3.value = "";
            input4.value = "";
            document.getElementById("male").checked = true;
        }

        class StudentManager {
            constructor() {
                this.students = [];
                this.editIndex = null;
            }

            addOrEditStudent(e) {
                e.preventDefault();

                let grid = input1.value;
                let name = input2.value;
                let course = input3.value;
                let age = input4.value;
                let gender = document.querySelector('input[name="gender"]:checked').value;

                if (grid.trim() === "" || name.trim() === "" || course.trim() === "" || age.trim() === "" || gender.trim() === "") {
                    Swal.fire({
                        icon: "error",
                        title: "Please Fill All Field",
                    });
                    return;
                }

                if (grid.length < 2 || grid.length > 4) {
                    Swal.fire({
                        icon: "error",
                        title: "GR ID must be between 2 and 4 characters!",
                    });
                    return;
                }

                const exists = this.students.some((stu, idx) => {
                    return stu.grid === grid && idx !== this.editIndex;
                });
                if (exists) {
                    Swal.fire({
                        icon: "error",
                        title: "This GR ID already exists!",
                    });
                    return;
                }

                if (this.editIndex != null) {
                    this.students[this.editIndex].grid = grid;
                    this.students[this.editIndex].name = name;
                    this.students[this.editIndex].course = course;
                    this.students[this.editIndex].age = age;
                    this.students[this.editIndex].gender = gender;

                    Swal.fire({
                        title: "Student Updated",
                        icon: "success",
                    });
                } else {
                    const stu = new Student(grid, name, course, age, gender);
                    this.students.push(stu);

                    Swal.fire({
                        title: "Student Added",
                        icon: "success",
                    });
                }

                this.showStudent();
                this.editIndex = null;
                submitBtn.innerHTML = "Insert";
                clearData();
            }

            showStudent() {
                document.getElementById("result").innerHTML = "";

                this.students.forEach((data, idx) => {
                    document.getElementById("result").innerHTML += `
                        <tr>
                            <td class="align-middle">${idx + 1}</td>
                            <td class="align-middle">${data.grid}</td>
                            <td class="align-middle">${data.name}</td>
                            <td class="align-middle">${this.getCourse(data.course)}</td>
                            <td class="align-middle">${data.age}</td>
                            <td class="align-middle">${data.gender}</td>
                            <td class="align-middle">
                                <div class="d-flex justify-content-center gap-2 align-items-center">
                                    <button class="update-btn" onclick="stuManager.updateStudent(${idx})"><i class="ri-edit-line"></i></button>
                                    <button class="delete-btn" onclick="stuManager.deleteStudent(${idx})"><i class="ri-delete-bin-line trash"></i></button>
                                </div>
                            </td>
                        </tr>
                    `;
                })
            }

            deleteStudent(idx) {
                Swal.fire({
                    title: "Are you sure?",
                    text: "This student record will be deleted!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#d33",
                    cancelButtonColor: "#3085d6",
                    confirmButtonText: "Yes, delete it!",
                    cancelButtonText: "Cancel"
                }).then((result) => {
                    if (result.isConfirmed) {
                        this.students.splice(idx, 1);
                        this.showStudent();

                        Swal.fire({
                            title: "Deleted!",
                            text: "The student has been deleted.",
                            icon: "success",
                            timer: 1500,
                            showConfirmButton: false
                        });
                    }
                });
            }

            updateStudent(idx) {
                this.editIndex = idx;
                const stu = this.students[this.editIndex];

                input1.value = stu.grid;
                input2.value = stu.name;
                input3.value = stu.course;
                input4.value = stu.age;
                document.querySelector(`input[name="gender"][value="${stu.gender}"]`).checked = true;
                submitBtn.innerHTML = "Update";
            }

            getCourse(course) {
                switch (course) {
                    case "1":
                        return "Full Stack Development";
                    case "2":
                        return "UI / UX Design";
                    case "3":
                        return "AI / ML";
                }
            }
        }

        class Student {
            constructor(grid, name, course, age, gender) {
                this.grid = grid;
                this.name = name;
                this.course = course;
                this.age = age;
                this.gender = gender;
            }
        }

        const stuManager = new StudentManager();
        document.addEventListener("DOMContentLoaded", function () {
            document.getElementById("clr").addEventListener("click", () => {
                clearData();
            })

            submitBtn.addEventListener("click", function (e) {
                stuManager.addOrEditStudent(e);
            })
        })
    </script>
</body>

</html>